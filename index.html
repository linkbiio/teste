<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Binaryclub — Login</title>
  <style>
    :root{
      --bg:#0b0b0f;
      --card:#0f0f14;
      --accent:#c59b00;
      --muted:#bfbfbf;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box;font-family:Inter, system-ui, Arial, sans-serif}
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg,#050507 0%, #0b0b0f 60%);
      color:#fff;
      padding:20px;
    }
    .container{
      width:100%; max-width:920px; display:grid; grid-template-columns:420px 1fr; gap:24px;
      align-items:start;
    }
    .brand {
      background: linear-gradient(90deg, rgba(197,155,0,0.12), transparent);
      border:1px solid rgba(197,155,0,0.12);
      padding:28px; border-radius:14px; box-shadow:0 6px 30px rgba(0,0,0,0.6);
    }
    .logo {
      display:flex; gap:14px; align-items:center; margin-bottom:18px;
    }
    .logo .badge{
      width:72px;height:72px;border-radius:14px;background:linear-gradient(135deg,var(--accent),#ffd86b);
      display:flex;align-items:center;justify-content:center;font-weight:800;color:#111;font-size:22px;
      box-shadow: 0 6px 20px rgba(197,155,0,0.12);
    }
    .logo h1{margin:0;font-size:1.6rem}
    .card{
      background:var(--card); padding:20px; border-radius:12px; border:1px solid var(--glass);
    }
    label{display:block;margin-top:12px;font-size:0.9rem;color:var(--muted)}
    input[type="text"], input[type="password"], input[type="date"]{
      width:100%;padding:12px;margin-top:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);
      background:transparent;color:#fff;
    }
    button{
      margin-top:14px;padding:12px 16px;border-radius:10px;border:none;background:var(--accent);color:#111;
      font-weight:700; cursor:pointer;
    }
    .link{color:var(--accent); cursor:pointer; text-decoration:underline; font-weight:600}
    .muted{color:var(--muted);font-size:0.9rem}
    .admin-area{display:none}
    .users-table{width:100%;border-collapse:collapse;margin-top:12px}
    .users-table th,.users-table td{padding:8px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.03);font-size:0.9rem}
    .status-paid{color:#84ff8a;font-weight:700}
    .status-unpaid{color:#ff6b6b;font-weight:700}
    .small{font-size:0.85rem;color:var(--muted)}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .danger{background:#2f1a1a}
    .success{background:#173217}
    @media (max-width:860px){ .container{grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <!-- Left: Branding + Login/Register -->
    <div class="brand card">
      <div class="logo">
        <div class="badge">BC</div>
        <div>
          <h1>Binaryclub</h1>
          <div class="muted">Área de membros — Entre com seu usuário</div>
        </div>
      </div>

      <!-- Login form -->
      <div id="loginCard" class="card" style="background:transparent;border:none;padding:0;">
        <div class="topbar">
          <strong>Entrar</strong>
          <span class="small">Prototipo — não use em produção</span>
        </div>

        <label for="loginUser">Usuário</label>
        <input id="loginUser" type="text" placeholder="Seu usuário" autocomplete="username">

        <label for="loginPass">Senha</label>
        <input id="loginPass" type="password" placeholder="Senha" autocomplete="current-password">

        <button id="btnLogin">Entrar e redirecionar</button>

        <div style="display:flex;gap:10px;align-items:center;margin-top:10px">
          <span class="small">Não tem conta?</span>
          <a id="registerRedirect" class="link">Clique aqui</a>
        </div>

        <div id="loginMsg" class="small" style="margin-top:10px;color:#ffb86b;"></div>
      </div>

      <!-- Register (just creates a local account) -->
      <div id="registerCard" class="card" style="margin-top:18px;display:none;">
        <strong>Registrar nova conta</strong>
        <label for="regUser">Usuário</label>
        <input id="regUser" type="text" placeholder="Escolha um usuário">
        <label for="regPass">Senha</label>
        <input id="regPass" type="password" placeholder="Escolha uma senha">
        <button id="btnRegister">Criar conta</button>
        <div style="margin-top:8px" class="small">Ao se registrar, você ficará marcado como <strong>não pago</strong> até receber a liberação.</div>
        <div id="regMsg" class="small" style="margin-top:8px;color:#84ff8a"></div>
      </div>

      <div style="margin-top:18px" class="small">
        <strong>Nota:</strong> este protótipo usa armazenamento local no navegador (localStorage). Para **controle real de assinaturas** use um servidor/backend.
      </div>
    </div>

    <!-- Right: Painel / Área após login -->
    <div>
      <div id="afterLogin" class="card" style="display:none;">
        <div class="topbar">
          <div>
            <strong id="welcomeUser">Bem-vindo</strong>
            <div class="small" id="paidInfo">Status: —</div>
          </div>
          <div>
            <button id="btnLogout" class="danger">Sair</button>
          </div>
        </div>

        <div id="memberContent">
          <p class="small">Área do membro. Se estiver liberado (pagou), será redirecionado automaticamente quando entrar.</p>
          <div style="margin-top:12px">
            <button id="goNow" class="success">Ir para o site (manual)</button>
            <button id="openAdmin" style="margin-left:8px">Painel Admin</button>
          </div>
        </div>
      </div>

      <!-- Admin area -->
      <div id="adminArea" class="card admin-area">
        <div class="topbar">
          <strong>Painel ADMIN</strong>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="small">Logado como admin</span>
            <button id="closeAdmin" style="margin-left:8px">Fechar</button>
          </div>
        </div>

        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <div style="flex:1;min-width:220px">
            <label>Definir link de redirecionamento (quando usuário entrar)</label>
            <input id="redirectUrl" type="text" placeholder="https://seusite.com/area-restrita">
            <label style="margin-top:8px">Link de pagamento (página externa)</label>
            <input id="paymentUrl" type="text" placeholder="https://pagamento.exemplo/">
            <button id="saveSettings">Salvar configurações</button>
            <div id="settingsMsg" class="small" style="margin-top:8px;color:var(--muted)"></div>
          </div>

          <div style="flex:1;min-width:260px">
            <strong>Marcar pagamento</strong>
            <label>Usuário</label>
            <select id="selectUserPay"></select>
            <label>Data até</label>
            <input id="paidUntil" type="date">
            <button id="markPaid">Marcar como pago até</button>
            <div style="margin-top:8px" class="small">Ou marque como não pago clicando no X na lista de usuários.</div>
          </div>
        </div>

        <table class="users-table" id="usersTable" style="margin-top:14px">
          <thead>
            <tr><th>Usuário</th><th>Pago até</th><th>Status</th><th>Ações</th></tr>
          </thead>
          <tbody id="usersBody"></tbody>
        </table>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
          <button id="exportBtn">Exportar dados (JSON)</button>
          <button id="importBtn">Importar dados (colar JSON)</button>
          <button id="resetBtn" class="danger">Resetar tudo (apagar)</button>
        </div>
      </div>

      <!-- Login admin prompt -->
      <div id="adminLoginPrompt" class="card" style="display:none;margin-top:12px;">
        <strong>Entrar como ADMIN</strong>
        <label>Usuário</label>
        <input id="adminUser" type="text" placeholder="admin">
        <label>Senha</label>
        <input id="adminPass" type="password" placeholder="1234">
        <button id="btnAdminLogin">Entrar como ADMIN</button>
        <div id="adminMsg" class="small" style="margin-top:8px;color:#ffb86b"></div>
      </div>
    </div>
  </div>

<script>
/*
  Binaryclub — protótipo de login + painel admin para marcar pagamentos.
  Configurações rápidas (edite aqui abaixo):
*/
const CONFIG = {
  // Link para "Não tem conta? Clique aqui" (registro externo) - altere para qualquer URL
  registerRedirectURL: "https://example.com/cadastre-se",

  // Link para pagar (quando usuário não pagou) - pode ser Hotmart/WhatsApp etc.
  defaultPaymentURL: "https://example.com/pagar",

  // Link para onde redirecionar após login (quando pago). Pode ser externo.
  defaultRedirectURL: "https://example.com/area-restrita",

  // Credenciais ADMIN padrão (mude para algo seguro em produção)
  adminUser: "admin",
  adminPass: "1234",

  // Se quiser que após login de usuário pago faça o redirect automático, deixe true:
  autoRedirectWhenPaid: true
};

/* --- Utils: storage e manipulação de usuários --- */
function getStorage(){
  let raw = localStorage.getItem("binaryclub_data");
  if(!raw){
    // criar defaults: um admin não-consumidor (admins não são usuários normais)
    const base = { users: [], settings: { redirectUrl: CONFIG.defaultRedirectURL, paymentUrl: CONFIG.defaultPaymentURL } };
    localStorage.setItem("binaryclub_data", JSON.stringify(base));
    return base;
  }
  try { return JSON.parse(raw); } catch(e){ return {users:[], settings:{redirectUrl:CONFIG.defaultRedirectURL, paymentUrl:CONFIG.defaultPaymentURL}}; }
}
function saveStorage(obj){ localStorage.setItem("binaryclub_data", JSON.stringify(obj)); }

/* Add user (username unique) */
function addUser(username, password){
  if(!username || !password) return {ok:false, msg:"Preencha usuário e senha"};
  const st = getStorage();
  if(st.users.find(u=>u.username.toLowerCase()===username.toLowerCase())) return {ok:false, msg:"Usuário já existe"};
  st.users.push({ username, password, paidUntil: null, createdAt: new Date().toISOString() });
  saveStorage(st);
  return {ok:true};
}

/* find user */
function findUser(username){
  const st = getStorage();
  return st.users.find(u=>u.username.toLowerCase()===username.toLowerCase());
}

/* set paidUntil date or clear */
function setPaidUntil(username, isoDateOrNull){
  const st = getStorage();
  const u = st.users.find(x=>x.username.toLowerCase()===username.toLowerCase());
  if(!u) return false;
  u.paidUntil = isoDateOrNull ? (new Date(isoDateOrNull)).toISOString() : null;
  saveStorage(st); return true;
}

/* remove all data (use with cuidado) */
function resetAll(){
  localStorage.removeItem("binaryclub_data");
  getStorage();
}

/* export/import */
function exportJSON(){ return JSON.stringify(getStorage(), null, 2); }
function importJSON(str){
  try{
    const parsed = JSON.parse(str);
    if(typeof parsed !== 'object' || !Array.isArray(parsed.users)) return {ok:false,msg:'Formato inválido'};
    localStorage.setItem("binaryclub_data", JSON.stringify(parsed));
    return {ok:true};
  }catch(e){ return {ok:false,msg:e.message}; }
}

/* check if paid: returns {paid:bool, paidUntil:date|null} */
function checkPaid(userObj){
  if(!userObj) return {paid:false, paidUntil:null};
  if(!userObj.paidUntil) return {paid:false, paidUntil:null};
  const until = new Date(userObj.paidUntil);
  const now = new Date();
  return { paid: until >= now, paidUntil: until };
}

/* --- UI wiring --- */
document.addEventListener('DOMContentLoaded', ()=> {
  // elements
  const regLink = document.getElementById('registerRedirect');
  const btnLogin = document.getElementById('btnLogin');
  const btnRegister = document.getElementById('btnRegister');
  const loginMsg = document.getElementById('loginMsg');
  const regMsg = document.getElementById('regMsg');
  const loginCard = document.getElementById('loginCard');
  const registerCard = document.getElementById('registerCard');
  const adminLoginPrompt = document.getElementById('adminLoginPrompt');
  const adminArea = document.getElementById('adminArea');
  const afterLogin = document.getElementById('afterLogin');
  const welcomeUser = document.getElementById('welcomeUser');
  const paidInfo = document.getElementById('paidInfo');
  const btnLogout = document.getElementById('btnLogout');
  const openAdmin = document.getElementById('openAdmin');
  const btnAdminLogin = document.getElementById('btnAdminLogin');
  const adminMsg = document.getElementById('adminMsg');
  const usersBody = document.getElementById('usersBody');
  const selectUserPay = document.getElementById('selectUserPay');
  const markPaid = document.getElementById('markPaid');
  const paidUntil = document.getElementById('paidUntil');
  const redirectUrl = document.getElementById('redirectUrl');
  const paymentUrl = document.getElementById('paymentUrl');
  const saveSettings = document.getElementById('saveSettings');
  const settingsMsg = document.getElementById('settingsMsg');
  const goNow = document.getElementById('goNow');
  const closeAdmin = document.getElementById('closeAdmin');
  const exportBtn = document.getElementById('exportBtn');
  const importBtn = document.getElementById('importBtn');
  const resetBtn = document.getElementById('resetBtn');

  // initial link
  regLink.addEventListener('click', ()=> window.location.href = CONFIG.registerRedirectURL );

  // load settings
  const st = getStorage();
  redirectUrl.value = st.settings?.redirectUrl || CONFIG.defaultRedirectURL;
  paymentUrl.value = st.settings?.paymentUrl || CONFIG.defaultPaymentURL;

  // register
  btnRegister.addEventListener('click', ()=>{
    const u = document.getElementById('regUser').value.trim();
    const p = document.getElementById('regPass').value;
    const res = addUser(u,p);
    if(!res.ok){ regMsg.style.color='#ff6b6b'; regMsg.textContent = res.msg; return; }
    regMsg.style.color='#84ff8a'; regMsg.textContent = 'Conta criada! Aguarde liberação (admin).';
    document.getElementById('regUser').value=''; document.getElementById('regPass').value='';
    refreshUsersTable();
  });

  // login
  btnLogin.addEventListener('click', ()=>{
    const u = document.getElementById('loginUser').value.trim();
    const p = document.getElementById('loginPass').value;
    const user = findUser(u);
    if(!user || user.password !== p){ loginMsg.style.color='#ff6b6b'; loginMsg.textContent = 'Usuário ou senha inválidos.'; return; }
    const paid = checkPaid(user);
    // show afterLogin
    showMemberArea(user, paid);
    // redirect if paid and configured
    const st = getStorage();
    const rUrl = st.settings?.redirectUrl || CONFIG.defaultRedirectURL;
    if(paid.paid && CONFIG.autoRedirectWhenPaid){
      loginMsg.style.color='#84ff8a'; loginMsg.textContent = 'Login ok — você será redirecionado...';
      setTimeout(()=> window.location.href = rUrl, 900);
    } else {
      loginMsg.style.color='#ffb86b';
      loginMsg.textContent = 'Login ok. Acesso bloqueado: assinatura inativa.';
    }
  });

  // show member area
  function showMemberArea(user, paid){
    loginMsg.textContent = '';
    registerCard.style.display='none';
    loginCard.style.display='none';
    adminLoginPrompt.style.display='none';
    afterLogin.style.display='block';
    welcomeUser.textContent = `Olá, ${user.username}`;
    if(paid.paid){
      paidInfo.innerHTML = `Status: <span class="status-paid">PAGO até ${paid.paidUntil.toLocaleDateString()}</span>`;
    } else {
      paidInfo.innerHTML = `Status: <span class="status-unpaid">NÃO pago</span> — <a id="payLink" class="link">Pagar agora</a>`;
      document.getElementById('payLink').addEventListener('click', ()=> {
        const st = getStorage();
        window.open(st.settings?.paymentUrl || CONFIG.defaultPaymentURL, '_blank');
      });
    }
    // show admin button only for admin user
    if(user.username.toLowerCase() === CONFIG.adminUser.toLowerCase()){
      document.getElementById('openAdmin').style.display='inline-block';
    } else {
      document.getElementById('openAdmin').style.display='inline-block'; // you can hide if prefer
    }
  }

  // logout
  btnLogout.addEventListener('click', ()=>{
    afterLogin.style.display='none';
    loginCard.style.display='block';
    document.getElementById('loginUser').value=''; document.getElementById('loginPass').value='';
    loginMsg.textContent='';
  });

  // admin login prompt open
  openAdmin.addEventListener('click', ()=> {
    adminLoginPrompt.style.display='block';
    adminMsg.textContent='';
  });

  // admin login submit
  btnAdminLogin.addEventListener('click', ()=>{
    const aU = document.getElementById('adminUser').value.trim();
    const aP = document.getElementById('adminPass').value;
    if(aU === CONFIG.adminUser && aP === CONFIG.adminPass){
      adminLoginPrompt.style.display='none';
      adminArea.style.display='block';
      fillAdminUsers();
      adminMsg.textContent='';
    } else {
      adminMsg.style.color='#ff6b6b'; adminMsg.textContent = 'Credenciais admin inválidas.';
    }
  });

  closeAdmin.addEventListener('click', ()=> { adminArea.style.display='none'; });

  function fillAdminUsers(){
    const st = getStorage();
    // select
    selectUserPay.innerHTML = '';
    st.users.forEach(u=>{
      const opt = document.createElement('option'); opt.value = u.username; opt.textContent = u.username;
      selectUserPay.appendChild(opt);
    });
    refreshUsersTable();
  }

  function refreshUsersTable(){
    const st = getStorage();
    usersBody.innerHTML = '';
    st.users.forEach(u=>{
      const tr = document.createElement('tr');
      const paid = checkPaid(u);
      const tdName = document.createElement('td'); tdName.textContent = u.username;
      const tdPaid = document.createElement('td'); tdPaid.textContent = u.paidUntil ? new Date(u.paidUntil).toLocaleDateString() : '—';
      const tdStatus = document.createElement('td'); tdStatus.innerHTML = paid.paid ? '<span class="status-paid">PAGO</span>' : '<span class="status-unpaid">NÃO pago</span>';
      const tdActions = document.createElement('td');
      const btnUnpay = document.createElement('button'); btnUnpay.textContent='X'; btnUnpay.title='Marcar como não pago'; btnUnpay.style.marginRight='8px';
      btnUnpay.addEventListener('click', ()=> { if(confirm('Marcar '+u.username+' como NÃO pago?')){ setPaidUntil(u.username, null); refreshUsersTable(); fillAdminUsers(); }});
      const btnEdit = document.createElement('button'); btnEdit.textContent='Editar'; btnEdit.addEventListener('click', ()=>{
        // quick fill in payer
        selectUserPay.value = u.username;
        paidUntil.value = u.paidUntil ? (new Date(u.paidUntil)).toISOString().slice(0,10) : '';
      });
      tdActions.appendChild(btnUnpay); tdActions.appendChild(btnEdit);
      tr.appendChild(tdName); tr.appendChild(tdPaid); tr.appendChild(tdStatus); tr.appendChild(tdActions);
      usersBody.appendChild(tr);
    });
    // refill select options
    selectUserPay.innerHTML = '';
    st.users.forEach(u=>{ const opt = document.createElement('option'); opt.value = u.username; opt.textContent = u.username; selectUserPay.appendChild(opt); });
  }

  // mark paid
  markPaid.addEventListener('click', ()=>{
    const u = selectUserPay.value;
    const d = paidUntil.value;
    if(!u) { alert('Selecione um usuário'); return; }
    if(!d) { if(!confirm('Remover pagamento? OK para remover.')) return; setPaidUntil(u, null); refreshUsersTable(); alert('Pagamento removido'); return; }
    setPaidUntil(u, d);
    refreshUsersTable();
    alert('Pagamento atualizado para '+u);
  });

  // save settings
  saveSettings.addEventListener('click', ()=>{
    const st = getStorage();
    st.settings = st.settings || {};
    st.settings.redirectUrl = redirectUrl.value || CONFIG.defaultRedirectURL;
    st.settings.paymentUrl = paymentUrl.value || CONFIG.defaultPaymentURL;
    saveStorage(st);
    settingsMsg.textContent = 'Configurações salvas.';
    setTimeout(()=> settingsMsg.textContent = '', 2500);
  });

  // go now button
  goNow.addEventListener('click', ()=>{
    const st = getStorage();
    window.location.href = st.settings?.redirectUrl || CONFIG.defaultRedirectURL;
  });

  // export/import/reset
  exportBtn.addEventListener('click', ()=> {
    const data = exportJSON();
    const w = window.open('about:blank','_blank');
    w.document.write('<pre>'+escapeHtml(data)+'</pre>');
  });

  importBtn.addEventListener('click', ()=> {
    const txt = prompt('Cole o JSON exportado aqui:');
    if(!txt) return;
    const r = importJSON(txt);
    if(!r.ok) alert('Import falhou: '+r.msg); else { alert('Import ok'); fillAdminUsers(); }
  });

  resetBtn.addEventListener('click', ()=> {
    if(confirm('Tem certeza? Isso apagará TODOS os usuários e configurações locais.')){ resetAll(); fillAdminUsers(); alert('Reset ok'); }
  });

  function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

  // initial table fill
  fillAdminUsers();

  // convenience: create a demo user if no users exist
  (function ensureDemo(){
    const st = getStorage();
    if(st.users.length === 0){
      // create two demo users
      st.users.push({ username: "usuario1", password: "senha1", paidUntil: null, createdAt: new Date().toISOString() });
      st.users.push({ username: "pago", password: "senha2", paidUntil: new Date(Date.now() + 1000*60*60*24*30).toISOString(), createdAt: new Date().toISOString() });
      saveStorage(st);
      fillAdminUsers();
    }
  })();

  // helper: redirect link in register area to external
  // if you want inline register form, toggle display
  document.getElementById('registerRedirect').addEventListener('click', ()=> {});
}); // DOM ready
</script>
</body>
</html>
